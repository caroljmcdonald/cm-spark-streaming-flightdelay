{"paragraphs":[{"title":"Import needed packages","text":"import org.apache.spark._\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.Dataset\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.feature.VectorIndexer;\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.feature.Bucketizer\nimport org.apache.spark.ml.feature.PCA\n\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.ml.classification.DecisionTreeClassificationModel\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.tuning.ParamGridBuilder\nimport org.apache.spark.ml.tuning.CrossValidator\nimport org.apache.spark.ml.feature.VectorAssembler","user":"anonymous","dateUpdated":"2017-11-18T13:28:08-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark._\n\nimport org.apache.spark.sql.SparkSession\n\nimport org.apache.spark.sql.functions._\n\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.sql._\n\nimport org.apache.spark.sql.Dataset\n\nimport org.apache.spark.ml.Pipeline\n\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\n\nimport org.apache.spark.ml.feature.StringIndexer\n\nimport org.apache.spark.ml.feature.VectorIndexer\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nimport org.apache.spark.ml.feature.Bucketizer\n\nimport org.apache.spark.ml.feature.PCA\n\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\n\nimport org.apache.spark.ml.classification.DecisionTreeClassificationModel\n\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\n\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nimport org.apache.spark.ml.feature.StringIndexer\n\nimport org.apache.spark.ml.tuning.ParamGridBuilder\n\nimport org.apache.spark.ml.tuning.CrossValidator\n\nimport org.apache.spark.ml.feature.VectorAssembler\n"}]},"apps":[],"jobName":"paragraph_1511014878875_-177403835","id":"20170508-144514_403247535","dateCreated":"2017-11-18T06:21:18-0800","dateStarted":"2017-11-18T13:28:08-0800","dateFinished":"2017-11-18T13:28:32-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5092"},{"text":"%md \nFor this tutorial, we'll be using the Orange Telecoms Churn Dataset. It consists of cleaned customer activity data (features), along with a churn label specifying whether the customer canceled their subscription or not. The input  csv file has the following format: \nKS,128,415,No,Yes,25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10.0,3,2.7,1,False\n\nWe use a Scala case class and Structype to define the schema, corresponding to a line in the csv data file.","dateUpdated":"2017-11-18T06:21:18-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>For this tutorial, we&rsquo;ll be using the Orange Telecoms Churn Dataset. It consists of cleaned customer activity data (features), along with a churn label specifying whether the customer canceled their subscription or not. The input csv file has the following format:<br/>KS,128,415,No,Yes,25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10.0,3,2.7,1,False</p>\n<p>We use a Scala case class and Structype to define the schema, corresponding to a line in the csv data file.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1511014878899_-186637808","id":"20170530-122945_1594214131","dateCreated":"2017-11-18T06:21:18-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5093"},{"text":"","dateUpdated":"2017-11-18T06:21:18-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511014878901_-188946302","id":"20170523-161130_2119104935","dateCreated":"2017-11-18T06:21:18-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5094"},{"title":"Define Schema for csv file data","text":"  case class Flight(dofM: Integer, dofW: Integer,fldate: String, carrier: String, flnum:String, origin: String, dest: String,  crsdephour: Long, crsdeptime: Integer, depdelay: Double, crsarrtime: Integer, arrdelay: Double, crselapsedtime: Double, dist: Double)\n \n  val schema = StructType(Array(\n    StructField(\"DAY_OF_MONTH\", IntegerType, true),\n    StructField(\"DAY_OF_WEEK\", IntegerType, true),\n   StructField( \"FL_DATE\", DateType, true),\n    StructField(\"CARRIER\", StringType, true),\n    StructField(\"FL_NUM\", StringType, true),\n    StructField(\"ORIGIN\", StringType, true),\n    StructField(\"DEST\", StringType, true),\n    StructField(\"CRS_DEP_TIME\", IntegerType, true),\n    StructField(\"DEP_DELAY_NEW\", DoubleType, true),\n    StructField(\"CRS_ARR_TIME\", IntegerType, true),\n    StructField(\"ARR_DELAY_NEW\", DoubleType, true),\n    StructField(\"CRS_ELAPSED_TIME\", DoubleType, true),\n    StructField(\"DISTANCE\", DoubleType, true)\n  ))\n","user":"anonymous","dateUpdated":"2017-11-22T19:56:49-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndefined class Flight\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(DAY_OF_MONTH,IntegerType,true), StructField(DAY_OF_WEEK,IntegerType,true), StructField(FL_DATE,DateType,true), StructField(CARRIER,StringType,true), StructField(FL_NUM,StringType,true), StructField(ORIGIN,StringType,true), StructField(DEST,StringType,true), StructField(CRS_DEP_TIME,IntegerType,true), StructField(DEP_DELAY_NEW,DoubleType,true), StructField(CRS_ARR_TIME,IntegerType,true), StructField(ARR_DELAY_NEW,DoubleType,true), StructField(CRS_ELAPSED_TIME,DoubleType,true), StructField(DISTANCE,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1511014878907_-189715799","id":"20170508-150032_326029627","dateCreated":"2017-11-18T06:21:18-0800","dateStarted":"2017-11-22T19:56:49-0800","dateFinished":"2017-11-22T19:56:50-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5095"},{"title":"Read the data from CSV file into a Dataset of Account type","text":"import spark.implicits._\n\nval df1 = spark.read.format(\"com.databricks.spark.csv\").schema(schema)\n  .option(\"header\", \"true\").option(\"treatEmptyValuesAsNulls\", \"true\").option(\"dateFormat\", \"yyyy-MM-dd\").load(\"/user/user01/apr.csv\")\n df1.take(1)\n\n  df1.count()\n  val df2 = df1.na.drop\n  df2.count()\n\nval upper: String => String = _.toLowerCase\nimport org.apache.spark.sql.functions.udf\nval upperUDF = udf { s: String => s.toLowerCase }\n\nval toDouble = udf { s: Integer => (s/100.0).round }\n\nval df = df2.withColumn(\"crsdephour\", toDouble(df2(\"CRS_DEP_TIME\")))\ndf.count\n\n\n\n","user":"anonymous","dateUpdated":"2017-12-01T22:27:19-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport spark.implicits._\n\ndf1: org.apache.spark.sql.DataFrame = [DAY_OF_MONTH: int, DAY_OF_WEEK: int ... 11 more fields]\n\nres205: Array[org.apache.spark.sql.Row] = Array([1,6,2017-04-01,NK,616,FLL,BOS,1606,0.0,1930,0.0,204.0,1237.0])\n\nres208: Long = 468329\n\ndf2: org.apache.spark.sql.DataFrame = [DAY_OF_MONTH: int, DAY_OF_WEEK: int ... 11 more fields]\n\nres209: Long = 459976\n\nupper: String => String = <function1>\n\nimport org.apache.spark.sql.functions.udf\n\nupperUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n\ntoDouble: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,LongType,Some(List(IntegerType)))\n\ndf: org.apache.spark.sql.DataFrame = [DAY_OF_MONTH: int, DAY_OF_WEEK: int ... 12 more fields]\n\nres214: Long = 459976\n"}]},"apps":[],"jobName":"paragraph_1511014878914_-204721006","id":"20170508-150131_378637203","dateCreated":"2017-11-18T06:21:18-0800","dateStarted":"2017-11-18T13:40:14-0800","dateFinished":"2017-11-18T13:40:37-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5096"},{"text":"df.show","user":"anonymous","dateUpdated":"2017-11-18T12:33:43-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+----------+-------+------+------+----+------------+-------------+------------+-------------+----------------+--------+----------+\n|DAY_OF_MONTH|DAY_OF_WEEK|   FL_DATE|CARRIER|FL_NUM|ORIGIN|DEST|CRS_DEP_TIME|DEP_DELAY_NEW|CRS_ARR_TIME|ARR_DELAY_NEW|CRS_ELAPSED_TIME|DISTANCE|crsdephour|\n+------------+-----------+----------+-------+------+------+----+------------+-------------+------------+-------------+----------------+--------+----------+\n|           1|          7|2017-01-01|     AA|  1655|   SAT| CLT|         828|          0.0|        1211|          0.0|           163.0|  1095.0|         8|\n|           1|          7|2017-01-01|     AA|  1659|   PHX| AUS|         942|         43.0|        1258|         53.0|           136.0|   872.0|         9|\n|           1|          7|2017-01-01|     AA|  1660|   LAX| PHL|        1120|          0.0|        1929|          0.0|           309.0|  2402.0|        11|\n|           1|          7|2017-01-01|     AA|  1663|   CLT| PHL|        1114|         10.0|        1253|         23.0|            99.0|   449.0|        11|\n|           1|          7|2017-01-01|     AA|  1663|   PIT| CLT|         835|          0.0|        1019|          3.0|           104.0|   366.0|         8|\n|           1|          7|2017-01-01|     AA|  1667|   PBI| PHL|        1405|          0.0|        1644|          0.0|           159.0|   951.0|        14|\n|           1|          7|2017-01-01|     AA|  1672|   ATL| CLT|         900|          0.0|        1012|         42.0|            72.0|   226.0|         9|\n|           1|          7|2017-01-01|     AA|  1672|   CLT| PBI|        1120|          0.0|        1315|          0.0|           115.0|   590.0|        11|\n|           1|          7|2017-01-01|     AA|  1673|   BWI| CLT|        1535|          0.0|        1707|          0.0|            92.0|   361.0|        15|\n|           1|          7|2017-01-01|     AA|  1673|   CLT| IAH|        1810|          0.0|        1958|          0.0|           168.0|   912.0|        18|\n|           1|          7|2017-01-01|     AA|  1674|   LAS| MIA|        2159|          0.0|         533|          0.0|           274.0|  2174.0|        22|\n|           1|          7|2017-01-01|     AA|  1675|   PHL| BOS|        2245|          0.0|        2356|          0.0|            71.0|   280.0|        22|\n|           1|          7|2017-01-01|     AA|  1676|   FLL| PHL|        1712|          0.0|        1955|          0.0|           163.0|   992.0|        17|\n|           1|          7|2017-01-01|     AA|  1676|   PHL| SEA|        2050|          0.0|        2355|          0.0|           365.0|  2378.0|        21|\n|           1|          7|2017-01-01|     AA|  1677|   CLT| PIT|         955|          0.0|        1126|          0.0|            91.0|   366.0|        10|\n|           1|          7|2017-01-01|     AA|  1677|   MSP| CLT|         510|          0.0|         854|          0.0|           164.0|   930.0|         5|\n|           1|          7|2017-01-01|     AA|  1678|   ATL| LGA|        1700|          0.0|        1912|          0.0|           132.0|   762.0|        17|\n|           1|          7|2017-01-01|     AA|  1678|   LGA| ATL|        1343|          0.0|        1620|          0.0|           157.0|   762.0|        13|\n|           1|          7|2017-01-01|     AA|  1679|   DTW| MIA|         525|          0.0|         841|          0.0|           196.0|  1145.0|         5|\n|           1|          7|2017-01-01|     AA|  1680|   PHL| PBI|        1855|          0.0|        2146|          0.0|           171.0|   951.0|        19|\n+------------+-----------+----------+-------+------+------+----+------------+-------------+------------+-------------+----------------+--------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1511015899808_1099829530","id":"20171118-063819_25280485","dateCreated":"2017-11-18T06:38:19-0800","dateStarted":"2017-11-18T12:33:43-0800","dateFinished":"2017-11-18T12:33:45-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5097"},{"text":"//df1.show\n","user":"anonymous","dateUpdated":"2017-11-18T12:24:22-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+--------------------+-------+------+----+------------+-------------+------------+-------------+----------------+--------+----+\n|DAY_OF_MONTH|DAY_OF_WEEK|             FL_DATE|CARRIER|ORIGIN|DEST|CRS_DEP_TIME|DEP_DELAY_NEW|CRS_ARR_TIME|ARR_DELAY_NEW|CRS_ELAPSED_TIME|DISTANCE|_c12|\n+------------+-----------+--------------------+-------+------+----+------------+-------------+------------+-------------+----------------+--------+----+\n|           1|          7|2017-01-01 00:00:...|     AA|   ORD| DFW|         710|          0.0|         948|          0.0|           158.0|   802.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   LAS| DFW|        1235|          0.0|        1718|          0.0|           163.0|  1055.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   DCA| MIA|        1020|          0.0|        1313|          0.0|           173.0|   919.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   TPA| MIA|         730|          0.0|         833|          0.0|            63.0|   204.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   PHL| PBI|        1015|          0.0|        1312|          0.0|           177.0|   951.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   PIT| PHL|         705|          0.0|         832|          0.0|            87.0|   268.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| DFW|         925|          0.0|        1122|          0.0|           177.0|   936.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| DTW|        2220|          9.0|           6|          0.0|           106.0|   500.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| DFW|        1615|          0.0|        1815|         15.0|           180.0|   936.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   FLL| CLT|        1305|          0.0|        1504|          0.0|           119.0|   632.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   DCA| MIA|        1732|          0.0|        2034|          0.0|           182.0|   919.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   MIA| DCA|        1410|         67.0|        1642|         59.0|           152.0|   919.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   IND| CLT|         700|          0.0|         849|          0.0|           109.0|   427.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| RDU|         939|          0.0|        1035|          0.0|            56.0|   130.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| BOS|        2029|         80.0|        2238|         60.0|           129.0|   728.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   LAX| CLT|        1147|         11.0|        1925|          1.0|           278.0|  2125.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| ORF|        2011|          8.0|        2122|         15.0|            71.0|   290.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   STL| CLT|        1617|          0.0|        1905|          2.0|           108.0|   575.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   PHL| MCO|        1750|          0.0|        2030|          0.0|           160.0|   861.0|null|\n|           1|          7|2017-01-01 00:00:...|     AA|   CLT| PDX|        1816|         34.0|        2100|         26.0|           344.0|  2282.0|null|\n+------------+-----------+--------------------+-------+------+----+------------+-------------+------------+-------------+----------------+--------+----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1511016088702_-1976529086","id":"20171118-064128_1684558492","dateCreated":"2017-11-18T06:41:28-0800","dateStarted":"2017-11-18T06:42:30-0800","dateFinished":"2017-11-18T06:42:31-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5098"},{"text":" // df1.count()\n // val df = df1.na.drop\n//  df.count()","user":"anonymous","dateUpdated":"2017-11-18T12:24:33-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres49: Long = 450017\n\ndf: org.apache.spark.sql.DataFrame = [DAY_OF_MONTH: int, DAY_OF_WEEK: int ... 11 more fields]\n\nres50: Long = 439645\n"}]},"apps":[],"jobName":"paragraph_1511018399280_-1912181906","id":"20171118-071959_696622359","dateCreated":"2017-11-18T07:19:59-0800","dateStarted":"2017-11-18T08:06:53-0800","dateFinished":"2017-11-18T08:06:59-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5099"},{"text":" df.createOrReplaceTempView(\"flights\")\n \n    val ds: Dataset[Flight] = spark.sql(\"select DAY_OF_MONTH as dofM, DAY_OF_WEEK as dofW, CARRIER as carrier,FL_DATE as fldate , FL_NUM as flnum, ORIGIN as origin, DEST as dest,crsdephour as crsdephour, CRS_DEP_TIME  as crsdeptime, DEP_DELAY_NEW as depdelay, CRS_ARR_TIME as crsarrtime ,ARR_DELAY_NEW as arrdelay, CRS_ELAPSED_TIME as crselapsedtime , DISTANCE as dist   from flights\").as[Flight]\n    println(\"ds :\" + ds.count() + \"ds :\" + df1.count())\n    ","user":"anonymous","dateUpdated":"2017-11-18T13:40:25-0800","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nds: org.apache.spark.sql.Dataset[Flight] = [dofM: int, dofW: int ... 12 more fields]\nds :459976ds :468329\n"}]},"apps":[],"jobName":"paragraph_1511014878916_-207029500","id":"20170508-150324_497571301","dateCreated":"2017-11-18T06:21:18-0800","dateStarted":"2017-11-18T13:40:25-0800","dateFinished":"2017-11-18T13:40:46-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5100"},{"title":"Register Dataset as a Table , display first 20 rows ","text":"    ds.show\n    ds.createOrReplaceTempView(\"flights\")\n\n    val df5 = ds.filter(\"origin in ('ORD', 'JKF', 'LGA', 'EWR','BOS', 'IAH', 'ATL', 'DEN', 'SFO', 'MIA')\")\n\n    val df6 = df5.filter(\"dest in ('ORD', 'JKF', 'LGA', 'EWR','BOS', 'IAH', 'ATL', 'DEN', 'SFO', 'MIA')\")\n    //df6.show\n\n    val df7 = df6.filter(\"carrier in ('AA', 'UA', 'DL', 'WN')\")\n    df7.show\n\n    println(\"ds :\" + ds.count() + \"ds :\" + df7.count())\n\n    df7.createOrReplaceTempView(\"flights\")","user":"anonymous","dateUpdated":"2017-11-18T13:40:29-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"stackedAreaChart":{}},"commonSetting":{},"keys":[{"name":"churn","index":19,"aggr":"sum"}],"groups":[],"values":[{"name":"len","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----+-------+----------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\n|dofM|dofW|carrier|    fldate|flnum|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+----+----+-------+----------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\n|   1|   6|     NK|2017-04-01|  616|   FLL| BOS|        16|      1606|     0.0|      1930|     0.0|         204.0|1237.0|\n|   1|   6|     NK|2017-04-01|  619|   FLL| IAH|        19|      1859|   151.0|      2055|   151.0|         176.0| 966.0|\n|   1|   6|     NK|2017-04-01|  619|   IAH| SAN|        21|      2140|   147.0|      2302|   148.0|         202.0|1303.0|\n|   1|   6|     NK|2017-04-01|  620|   LAX| MCI|        12|      1232|     0.0|      1742|    11.0|         190.0|1363.0|\n|   1|   6|     NK|2017-04-01|  624|   DEN| ORD|         6|       636|     0.0|       959|     2.0|         143.0| 888.0|\n|   1|   6|     NK|2017-04-01|  630|   ORD| LGA|        18|      1759|     0.0|      2112|     0.0|         133.0| 733.0|\n|   1|   6|     NK|2017-04-01|  631|   DTW| TPA|        17|      1732|     0.0|      2009|     0.0|         157.0| 983.0|\n|   1|   6|     NK|2017-04-01|  636|   TPA| DTW|        17|      1725|     0.0|      2003|     0.0|         158.0| 983.0|\n|   1|   6|     NK|2017-04-01|  639|   DTW| TPA|        10|      1027|     0.0|      1302|     0.0|         155.0| 983.0|\n|   1|   6|     NK|2017-04-01|  640|   LAS| BOS|        22|      2200|    11.0|       557|    19.0|         297.0|2381.0|\n|   1|   6|     NK|2017-04-01|  641|   BOS| LAS|        17|      1720|    86.0|      2022|    63.0|         362.0|2381.0|\n|   1|   6|     NK|2017-04-01|  642|   TPA| DTW|        14|      1402|     0.0|      1642|     0.0|         160.0| 983.0|\n|   1|   6|     NK|2017-04-01|  643|   DTW| TPA|         7|       740|     1.0|      1015|     3.0|         155.0| 983.0|\n|   1|   6|     NK|2017-04-01|  647|   IAG| FLL|         2|       236|     4.0|       532|     0.0|         176.0|1176.0|\n|   1|   6|     NK|2017-04-01|  650|   TPA| DTW|         7|       700|     0.0|       937|     0.0|         157.0| 983.0|\n|   1|   6|     NK|2017-04-01|  657|   FLL| MSY|         7|       700|   121.0|       806|   109.0|         126.0| 674.0|\n|   1|   6|     NK|2017-04-01|  657|   MSY| IAH|         9|       856|    90.0|      1016|    81.0|          80.0| 305.0|\n|   1|   6|     NK|2017-04-01|  667|   BOS| BWI|         7|       730|     0.0|       906|     0.0|          96.0| 369.0|\n|   1|   6|     NK|2017-04-01|  667|   BWI| DFW|        10|       951|     0.0|      1218|     0.0|         207.0|1217.0|\n|   1|   6|     NK|2017-04-01|  676|   FLL| MCO|        22|      2157|     5.0|      2256|    10.0|          59.0| 177.0|\n+----+----+-------+----------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\nonly showing top 20 rows\n\n\ndf5: org.apache.spark.sql.Dataset[Flight] = [dofM: int, dofW: int ... 12 more fields]\n\ndf6: org.apache.spark.sql.Dataset[Flight] = [dofM: int, dofW: int ... 12 more fields]\n\ndf7: org.apache.spark.sql.Dataset[Flight] = [dofM: int, dofW: int ... 12 more fields]\n+----+----+-------+----------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\n|dofM|dofW|carrier|    fldate|flnum|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime|  dist|\n+----+----+-------+----------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\n|   1|   6|     WN|2017-04-01|   27|   ATL| BOS|        17|      1730|    61.0|      2000|    60.0|         150.0| 946.0|\n|   1|   6|     WN|2017-04-01|  663|   ATL| BOS|        11|      1120|     0.0|      1355|     0.0|         155.0| 946.0|\n|   1|   6|     WN|2017-04-01|   55|   ATL| DEN|         6|       615|     0.0|       735|     0.0|         200.0|1199.0|\n|   1|   6|     WN|2017-04-01| 2571|   ATL| DEN|         9|       935|     0.0|      1055|     0.0|         200.0|1199.0|\n|   1|   6|     WN|2017-04-01| 4680|   ATL| DEN|        14|      1350|     0.0|      1510|     0.0|         200.0|1199.0|\n|   1|   6|     WN|2017-04-01| 6516|   ATL| DEN|        17|      1720|     1.0|      1840|     0.0|         200.0|1199.0|\n|   1|   6|     WN|2017-04-01|  202|   ATL| LGA|        16|      1620|     5.0|      1830|     0.0|         130.0| 762.0|\n|   1|   6|     WN|2017-04-01| 1790|   ATL| LGA|         6|       555|     3.0|       800|     0.0|         125.0| 762.0|\n|   1|   6|     WN|2017-04-01| 2452|   ATL| LGA|        11|      1125|     4.0|      1335|     0.0|         130.0| 762.0|\n|   1|   6|     WN|2017-04-01| 2550|   ATL| LGA|        20|      2005|     1.0|      2220|     0.0|         135.0| 762.0|\n|   1|   6|     WN|2017-04-01| 6524|   ATL| LGA|        13|      1330|     0.0|      1535|     0.0|         125.0| 762.0|\n|   1|   6|     WN|2017-04-01|  210|   BOS| ATL|         6|       550|     0.0|       845|     0.0|         175.0| 946.0|\n|   1|   6|     WN|2017-04-01| 1342|   BOS| ATL|        13|      1300|     9.0|      1555|     2.0|         175.0| 946.0|\n|   1|   6|     WN|2017-04-01|  709|   BOS| DEN|         9|       855|     0.0|      1135|     0.0|         280.0|1754.0|\n|   1|   6|     WN|2017-04-01| 2050|   BOS| DEN|        17|      1700|    11.0|      1945|     5.0|         285.0|1754.0|\n|   1|   6|     WN|2017-04-01|  510|   DEN| ATL|        19|      1930|    39.0|        15|    38.0|         165.0|1199.0|\n|   1|   6|     WN|2017-04-01| 2507|   DEN| ATL|        11|      1140|     5.0|      1630|     0.0|         170.0|1199.0|\n|   1|   6|     WN|2017-04-01| 6190|   DEN| ATL|         6|       600|     0.0|      1055|    19.0|         175.0|1199.0|\n|   1|   6|     WN|2017-04-01| 6337|   DEN| ATL|        16|      1630|     0.0|      2120|     0.0|         170.0|1199.0|\n|   1|   6|     WN|2017-04-01| 5199|   DEN| BOS|        19|      1930|     0.0|       120|     0.0|         230.0|1754.0|\n+----+----+-------+----------+-----+------+----+----------+----------+--------+----------+--------+--------------+------+\nonly showing top 20 rows\n\nds :459976ds :22149\n"}]},"apps":[],"jobName":"paragraph_1511014878919_-206644751","id":"20170508-150408_505244914","dateCreated":"2017-11-18T06:21:18-0800","dateStarted":"2017-11-18T13:40:38-0800","dateFinished":"2017-11-18T13:42:10-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5101"},{"text":" df7.write.format(\"json\").save(\"/user/user01/apr2017\")","user":"anonymous","dateUpdated":"2017-11-18T13:40:47-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1511021356328_-1670776377","id":"20171118-080916_1359229211","dateCreated":"2017-11-18T08:09:16-0800","dateStarted":"2017-11-18T13:40:48-0800","dateFinished":"2017-11-18T13:43:17-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5102"},{"text":"%md \nuse Spark SQL to explore the dataset","dateUpdated":"2017-11-18T06:21:18-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>use Spark SQL to explore the dataset</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1511014878938_-201643015","id":"20170603-182655_1680505289","dateCreated":"2017-11-18T06:21:18-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5105"},{"dateUpdated":"2017-11-18T06:21:19-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511014879149_-99684557","id":"20171107-113000_1427348134","dateCreated":"2017-11-18T06:21:19-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5145"}],"name":"flightclean","id":"2CYCR16YX","angularObjects":{"2CTHAGJ51:shared_process":[],"2CTFEJCW1:shared_process":[],"2CU928YA7:shared_process":[],"2CUSCHS1V:shared_process":[],"2CTGXT5AB:shared_process":[],"2CUHXVGRB:shared_process":[],"2CSNF42WC:shared_process":[],"2CU45S3XK:shared_process":[],"2CV35ABMV:shared_process":[],"2CUH4E5VP:shared_process":[],"2CVNXVD14:shared_process":[],"2CW8GSR5S:shared_process":[],"2CWBB1M88:shared_process":[],"2CT4ZSMCD:shared_process":[],"2CUQTDJZW:shared_process":[],"2CSMEVREU:shared_process":[],"2CVD5FM5C:shared_process":[],"2CTNB4WJK:shared_process":[],"2CUBZKAK6:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}